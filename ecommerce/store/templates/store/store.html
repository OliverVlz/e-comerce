{% extends 'store/main.html' %}
{% load static %}
{% block content %}
    <div class="row">
        {% for product in products %}
        <div class="col-lg-4 col-md-6 mb-4">
            <!-- Enlace envolviendo la tarjeta completa -->
            <a href="{% url 'product_detail' product.id %}" class="card-link-wrapper" style="text-decoration: none;">
                <div class="card h-100 shadow-sm rounded-3 product-card" style="transition: transform 0.2s, box-shadow 0.2s;">
                    <img class="card-img-top" 
                        src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'images/placeholder.png' %}{% endif %}" 
                        alt="{{ product.name }}">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title font-weight-bold text-center">{{ product.name }}</h5>
                        <hr>
                        <h4 class="text-center text-primary"><strong>${{ product.price|floatformat:2 }}</strong></h4> <!-- Precio centrado -->
                        <div class="mt-auto text-center"> <!-- Contenedor centrado -->
                            <div class="btn-group"> <!-- Grupo de botones centrado -->
                                <a href="{% url 'add_to_cart' product.id %}" class="btn btn-primary add-to-cart">Añadir al carrito</a>
                                <button type="button" class="btn btn-outline-success ms-2 view-details">Detalles</button>
                            </div>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>

    <style>
        /* Efecto hover en la tarjeta del producto */
        .product-card:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        /* Estilos para los botones */
        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }

        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }

        .card-img-top {
            height: 250px;
            object-fit: cover;
        }

        .btn-group {
            display: flex;
            justify-content: center; /* Centra los botones horizontalmente */
        }

        .btn-group .btn {
            min-width: 120px; /* Ancho mínimo para los botones */
            margin: 5px; /* Espacio entre botones */
        }

        .text-center {
            text-align: center;
        }

        .text-primary {
            color: #007bff;
        }

        /* Asegurar que el enlace no afecte el diseño de la tarjeta */
        .card-link-wrapper {
            display: block;
            color: inherit; /* Mantener el color del texto */
            text-decoration: none; /* Sin subrayado */
        }

        /* Deshabilitar pointer-events para el enlace completo cuando se hace clic en un botón */
        .card-link-wrapper .btn, .card-link-wrapper .btn-outline-success {
            pointer-events: none;
        }

        /* Quitar la sombra del enlace cuando se hace hover en los botones */
        .card-link-wrapper:hover .product-card {
            box-shadow: none;
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var cardLinks = document.querySelectorAll('.card-link-wrapper');
            cardLinks.forEach(function(cardLink) {
                // Deshabilitar la redirección de la tarjeta cuando se hace clic en los botones internos
                var addToCartButton = cardLink.querySelector('.add-to-cart');
                var viewDetailsButton = cardLink.querySelector('.view-details');
                
                addToCartButton.addEventListener('click', function(event) {
                    event.stopPropagation(); // Evita la redirección
                });

                viewDetailsButton.addEventListener('click', function(event) {
                    event.stopPropagation(); // Evita la redirección
                    window.location.href = cardLink.href; // Redirige al enlace de detalles
                });
            });
        });
    </script>
{% endblock content %}
